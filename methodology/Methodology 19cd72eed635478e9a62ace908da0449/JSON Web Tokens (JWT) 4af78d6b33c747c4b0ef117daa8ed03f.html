<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="../../../../../../assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="../../../../../../assets/css/search.css">
    <link rel="stylesheet" href="../../../../../../assets/css/method-styles.css">



    <title>Methodology</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="../../../../../index.html#home" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <div class="search-bar">
                <input type="text" id="searchInput" class="search-input" placeholder="Search Notes...">
                <!-- <button onclick="search()" class="search-button">Search</button> -->
                <div id="searchResults" class="search-results"></div>

              </div>

            </div>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="../../../../../index.html#home" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <!-- <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div> -->
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="4af78d6b-33c7-47c4-b0ef-117daa8ed03f" class="page sans"><header><h1 class="page-title">JSON Web Tokens (JWT)</h1><p class="page-description"></p></header><div class="page-body"><ul id="3f463fda-c22c-4cdb-927f-1eaccf114f78" class="bulleted-list"><li style="list-style-type:disc">JWT.io</li></ul><ul id="1baf3f5a-35e1-4e4c-8e60-e64c14235f90" class="bulleted-list"><li style="list-style-type:disc">JWT are comprised of a header, body, and a encryption key. <ul id="a3be9e86-65a5-425c-b354-97929d291500" class="bulleted-list"><li style="list-style-type:circle">We can learn about the data within the token if we have the key.</li></ul></li></ul><p id="fcbc90d4-062e-4bc7-a2ae-cda97a65837c" class=""><strong>jwt_tool</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ad5bcdbb-ecfc-44e7-b7b6-99d13b394dd8" class="code"><code class="language-Java"></code></pre><p id="599ab2f5-a6fa-497b-ac3c-f3b58460593c" class=""><strong>Header - </strong>Used to describe encryption algorithm is being used. Several popular options exist and most of them require a key as well.</p><p id="cd8de495-b562-48ad-b12d-b269a8f8dc07" class="">
</p><p id="af214502-e35e-4be9-ba20-e41671ddfc82" class=""><strong>Body/Payload - </strong> Usually describes certain properties of a user. This can be information we might want to change to test the authorization module.</p><p id="6b595389-db28-449d-803c-06424b1d6455" class="">
</p><p id="ab596e71-41c0-47f8-9bb5-2d92d32e86ef" class=""><strong>Key/Signature - </strong> If you get this wrong, the server will never accept your JWT; but if you are able to get the key and encode the value that is equally a very bad problem.</p><h2 id="028b6a66-ae2c-441e-b384-9314bef3665c" class=""><strong>Common attacks:</strong></h2><p id="ea884c46-0121-4653-9012-6076398e340d" class=""><strong>Hashing algorithm none - W</strong>hen the server accepts JWT tokens with the header that indicated the use of no key. This will allow us to easily forge any token we want.</p><p id="c2500eb3-6fcc-443e-9679-bc7cfc0c149a" class="">
</p><p id="a34aa286-bdca-48f1-a18f-6c27c513531d" class=""><strong>JWT manipulation - </strong>Sometimes, user controlled values end up in a JWT token. This should never ever be the case but since some application abuse JWT tokens for authentication rather than authorization, we can still play with the contents of the JWT by changing the username to something that interrupts the current JWT structure and insert our own. This means we might be able to change values and make ourselves admin or even login as other users if the system is built in a bad way.</p><p id="547e587d-5c1b-4f62-b940-4042670e8a81" class="">i.e.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a68e275a-854c-46e7-9299-a7ccadb5201e" class="code"><code class="language-Python">{

&quot;username&quot;:&quot;attack&quot;,

&quot;isAdmin&quot;:&quot;false&quot;

}

Might turn into

{

&quot;username&quot;:&quot;attack&quot;,

&quot;isAdmin&quot;:&quot;false&quot;

}

&quot;isAdmin&quot;:&quot;false&quot;

}</code></pre><p id="e2c0994f-a6d3-42c7-8d54-0f2ea6699262" class="">
</p><p id="7b48af42-2057-4387-8ede-ead7bfbe3099" class="">
</p><p id="935be593-f16b-4394-996c-ac1435148704" class=""><strong>Token side jacking - </strong>This exploit is basically intercepting the token/key and using it to sign a valid JWT. This can be very basic like a leaked token on the source code of a website. This can be prevented and we will get more into that into another article.</p><p id="d0a61c6b-301e-4746-a6ca-c824204a1eb0" class="">
</p><p id="6f83ae41-340e-47d2-ba15-854ce32a6c1d" class=""><strong>Weak token secrets - </strong>Of course just like with any key, this one is vulnerable to being weak and easy to brute force so pick a solid key and make sure it does not leak.</p><p id="3df99785-908c-489c-bf33-409676c24a58" class="">
</p><p id="affbaa61-543a-4adb-a9b3-a5024e6a5e82" class=""><strong>Long lasting tokens - </strong>Normally, every token contains an expiration field. Usually it’s called “exp” but it might be called something different. Make sure the server actually disregards any JWTs that are no longer valid.</p><p id="47b7388d-bd41-43e5-a897-98743569d2fa" class="">
</p><p id="88a18514-306d-4504-b29c-430267518704" class="">
</p><p id="8be558b4-eecf-4427-ba27-04e1a8e56e21" class=""><strong>JWT “none” algorithm</strong></p><ul id="3b1f2674-7e37-4f1d-9e7e-89304c000413" class="bulleted-list"><li style="list-style-type:disc">editing the signatures signing algorithm</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d4ad785b-dd28-4ce3-8eb7-2188ba1bb50e" class="code"><code class="language-Python">{
“alg”: “none”

}</code></pre><p id="c6ad8ccb-e12c-4e2d-acc7-8a289e43d2d3" class="">
</p><p id="48116137-4027-43bd-8524-14beb6c6fc7a" class="">
</p><p id="5e8b6e2a-bff9-4333-b2bd-a118a72240dc" class="">
</p><p id="9a6b2c96-1bbc-4477-9e55-818880c74964" class=""><strong>JWT authentication bypass via unverified signature:</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="28af0501-c01c-479a-abcc-a02026aa5019" class="code"><code class="language-Python"></code></pre><p id="a6234ac5-6bcd-473a-92d4-6d281991630e" class="">
</p><p id="847bd5a6-821e-4211-8e55-471a64b652cf" class=""><strong>JWT authentication bypass via flawed signature verification:</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b84da966-3781-460e-8202-b8e7d3409dc9" class="code"><code class="language-Python"></code></pre><p id="0358784f-598d-4460-929c-0e60615d2091" class="">
</p><p id="27e8eb7b-8aa4-43f7-8d66-3a06696edea5" class=""><strong>JWT authentication bypass via jwk header injection:</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6a3a955b-821e-4502-8316-bd529e21c0c4" class="code"><code class="language-Python"></code></pre><p id="38147ac4-831e-4937-9153-7853205dccc7" class="">
</p><p id="5998d03e-3d71-4ac6-a3d1-9171fe8d28f1" class=""><strong>JWT authentication bypass via jwu header injection:</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ecb6fb26-ab9d-4216-9407-849f8ea9a8fd" class="code"><code class="language-Python"></code></pre><p id="bb6dd3d7-2c4d-4d78-aa7b-2cf205c2d35e" class="">
</p><p id="4613e46d-65f9-4807-9be9-2c98d250209c" class="">
</p><p id="5f1c8047-39c8-4671-830e-8d949fa5f498" class=""><strong>JWT authentication bypass via kid header path traversal:</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3b4f2db4-7efe-4f04-8c56-0846f267b91b" class="code"><code class="language-Python"></code></pre></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="../../../../../index.html#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="../../../../../index.html#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="../../../../../../../index.html#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="../../../../../../assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="../../../../../../assets/js/main.js"></script>
    <script src="../../../../../../assets/js/search.js"></script>


</body>
</html>